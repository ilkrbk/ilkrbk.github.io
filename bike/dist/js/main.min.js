jQuery(document).ready(function(){    
    $('.header__wrap-icon-btn').click(function(){
            $('.header__icon-btn').toggleClass('header__btn--active');
            $('.header__wrap-icon-btn').toggleClass('header__wrap-btn--active');            
            $('.header__nav').toggleClass('header__nav--active');
    });
});

function scrolling_(){
    this.list = document.querySelector(".header__list");
    
    this.list.addEventListener('click', (e) =>{
        e.preventDefault()
        this.posElem = document.querySelector(e.target.getAttribute('href')).getBoundingClientRect().y
        this.scrollTop = window.pageYOffset || document.documentElement.scrollTop
        if (0 < this.posElem){
            $('body, html').animate({
                scrollTop: this.posElem + this.scrollTop
              }, 500)
        } else {         
            $('body, html').animate({
                scrollTop: this.posElem + this.scrollTop
              }, 500)
        }
    });
}
scrolling_();
function modal(){
  var modal = document.getElementById('modal');
  var span = document.querySelectorAll(".modal__close")[0];
  span.addEventListener('click', () => {
    modal.style.display = "none";
  })
  
  var images = document.querySelectorAll('.gallery__img');
  var modalImg = document.getElementById("modal1");
  var i;
  for (i = 0; i < images.length; i++) {
     images[i].onclick = function(){
         modal.style.display = "block";
         modalImg.src = this.src;
     }
  }
}
modal();

var btn = document.querySelector('.gallery__btn');
var list = document.querySelector('.gallery__list');
var num = 0;

function loadData() {    
    var xhr = new XMLHttpRequest();
    xhr.open('GET', 'https://ilkrbk.github.io/bike/dist/list.json');
    xhr.responseType = 'json';
    
    xhr.onreadystatechange = function () {
        if (xhr.readyState === 4){
            let data = xhr.response;
            ``
            if (num < data.length) {
              num++;
              let li = document.createElement('li');
              li.classList.add('gallery__item');             
              list.appendChild(li);
              let img = document.createElement('img');
              img.setAttribute('src', `${data[num-1]}`);
              img.classList.add('gallery__img'); 
              li.appendChild(img);  
              let i = document.createElement('i');
              i.classList.add('fas'); 
              i.classList.add('fa-search-plus');                     
              li.appendChild(i);
              modal();
            } if (num >= data.length) {
              btn.classList.add('gallery__btn--none')
            }
        }
    }
    xhr.send();
}

btn.addEventListener('click', loadData);
$(function() {
    $('.scroll-to-top').on('click', function() {
      $('body, html').animate({
        scrollTop: 0
      }, 500)
    })

    $(window).on('scroll', function() {
      var _block = $('.video').height()
          _btn = $('.scroll-to-top');

      if( $(window).scrollTop() >= _block ) {
        _btn.addClass('scroll-to-top--active');
      } else {
        _btn.removeClass('scroll-to-top--active');
      }
    });
});
function blogModal(){
  var modal = document.getElementById('blogModal');
  var span = document.querySelectorAll(".blog__modal--close")[0];
  span.addEventListener('click', () => {
    modal.style.display = "none";
    $("body").css("overflow-y","scroll"); 
    $(".blog__item-descr").css("display","none");       
  })
  
  var images = document.querySelectorAll('.blog__img');
  var modalImg = document.getElementById("blogModal1");
  var captionText = document.getElementById("blogCaption");
  var i;
  for (i = 0; i < images.length; i++) {
      images[i].onclick = function(){
        modal.style.display = "block";
        modalImg.src = this.src;
        captionText.innerHTML = this.nextElementSibling.innerHTML;
        $("body").css("overflow","hidden"); 
        $("#blogCaption .blog__item-descr").css("display","block"); 
      }
  }
}
blogModal();

var blogBtn = document.querySelector('.blog__btn');
var bloglist = document.querySelector('.blog__list');
var blognum = 0;

function loadBlog() {    
  var xhr = new XMLHttpRequest();
  xhr.open('GET', 'https://ilkrbk.github.io/bike/dist/blogList.json');
  xhr.responseType = 'json';
  
  xhr.onreadystatechange = function () {
    if (xhr.readyState === 4){
      let data = xhr.response;
      ``
      if (blognum < data.length) {
        for(let k = 0; k < 7; k++){
          blognum++;
          let li = document.createElement('li');
          li.classList.add('blog__item');             
          bloglist.appendChild(li);
          let img = document.createElement('img');
          img.setAttribute('src', `${data[blognum-1].img}`);
          img.classList.add('blog__img'); 
          li.appendChild(img);  
          let textWrap = document.createElement('div');
          textWrap.classList.add('blog__text-wrap');
          li.appendChild(textWrap);
          let title = document.createElement('h3');
          title.classList.add('blog__item-title');
          textWrap.appendChild(title);
          title.innerHTML = data[blognum-1].title; 
          let descr = document.createElement('p');
          descr.classList.add('blog__item-descr');
          textWrap.appendChild(descr);
          descr.innerHTML = data[blognum-1].descr; 
          blogModal();
          let footer = document.createElement('footer');
          footer.classList.add('blog__footer');
          textWrap.appendChild(footer);
          let date = document.createElement('date');
          date.classList.add('blog__item-date');
          footer.appendChild(date);
          date.innerHTML = data[blognum-1].date;
          let ul = document.createElement('ul');
          ul.classList.add('blog__social');
          footer.appendChild(ul);
          for(let i = 0; i < 2; i++){
            let ulLi = document.createElement('li');
            ulLi.classList.add('blog__icon-wrap');
            ul.appendChild(ulLi);
            let icon = document.createElement('i');
            icon.classList.add('blog__icon');
            icon.classList.add('fas');
            icon.classList.add(data[blognum-1].icon[i]);
            ulLi.appendChild(icon);
          }
          blogModal();
        }
      } if (blognum >= data.length) {
        blogBtn.classList.add('gallery__btn--none')
      }
    }
  }
  xhr.send();
}

blogBtn.addEventListener('click', loadBlog);
$('.partner__list').slick({
  centerMode: true,
  arrows: false,
  centerPadding: '60px',
  slidesToShow: 5,
  autoplay: true,
  responsive: [
    {
      breakpoint: 768,
      settings: {
        arrows: false,
        centerMode: true,
        centerPadding: '40px',
        slidesToShow: 3
      }
    },
    {
      breakpoint: 480,
      settings: {
        arrows: false,
        centerMode: true,
        centerPadding: '40px',
        slidesToShow: 1
      }
    }
  ]
});

$('.rating__list').slick({
  slidesToShow: 1,
  slidesToScroll: 1,
  arrows: true,
  fade: true,
  asNavFor: '.rating__list-nav'
});
$('.rating__list-nav').slick({
  slidesToShow: 2,
  slidesToScroll: 1,
  asNavFor: '.rating__list',
  arrows: false,  
  dots: false,
  responsive: [
    {
      breakpoint: 768,
      settings: {
        arrows: false,
        slidesToShow: 1
      }
    }
  ]
});
$(function () { 
    var target_block = $(".rating__list-nav");
    var blockStatus = true;  
    $(window).scroll(function() { 
        var scrollEvent = ($(window).scrollTop() > (target_block.position().top - $(window).height())); 
        if(scrollEvent && blockStatus) {  
            blockStatus = false;
                function countUp(numberElement) {
                    let current = 0;
                    const total = parseInt(numberElement.textContent);
                    const increment = Math.ceil(total / 100);
                    
                    function step() {
                    current += increment;
                    if (current > total) current = total;
                    numberElement.textContent = current.toLocaleString();
                    (current !== total) && requestAnimationFrame(step);
                    }
                    step();
                }
                
                document.querySelectorAll('.rating__num-nav').forEach(elem => countUp(elem));
            }
        }); 
    });
function initMap() {
    map = new google.maps.Map(document.getElementById('map'), {
        center: {lat: 48.4130154, lng: 15.4791684},
        zoom: 6,
        styles: [
            {
                "featureType": "administrative",
                "elementType": "all",
                "stylers": [
                    {
                        "visibility": "on"
                    },
                    {
                        "weight": "1"
                    }
                ]
            },
            {
                "featureType": "administrative.country",
                "elementType": "all",
                "stylers": [
                    {
                        "visibility": "on"
                    }
                ]
            },
            {
                "featureType": "landscape",
                "elementType": "all",
                "stylers": [
                    {
                        "visibility": "simplified"
                    },
                    {
                        "hue": "#0066ff"
                    },
                    {
                        "saturation": 74
                    },
                    {
                        "lightness": 100
                    }
                ]
            },
            {
                "featureType": "poi",
                "elementType": "all",
                "stylers": [
                    {
                        "visibility": "simplified"
                    }
                ]
            },
            {
                "featureType": "road",
                "elementType": "all",
                "stylers": [
                    {
                        "visibility": "simplified"
                    }
                ]
            },
            {
                "featureType": "road.highway",
                "elementType": "all",
                "stylers": [
                    {
                        "visibility": "off"
                    },
                    {
                        "weight": 0.6
                    },
                    {
                        "saturation": -85
                    },
                    {
                        "lightness": 61
                    }
                ]
            },
            {
                "featureType": "road.highway",
                "elementType": "geometry",
                "stylers": [
                    {
                        "visibility": "on"
                    }
                ]
            },
            {
                "featureType": "road.arterial",
                "elementType": "all",
                "stylers": [
                    {
                        "visibility": "off"
                    }
                ]
            },
            {
                "featureType": "road.local",
                "elementType": "all",
                "stylers": [
                    {
                        "visibility": "on"
                    }
                ]
            },
            {
                "featureType": "transit",
                "elementType": "all",
                "stylers": [
                    {
                        "visibility": "simplified"
                    }
                ]
            },
            {
                "featureType": "water",
                "elementType": "all",
                "stylers": [
                    {
                        "visibility": "simplified"
                    },
                    {
                        "color": "#5f94ff"
                    },
                    {
                        "lightness": 26
                    },
                    {
                        "gamma": 5.86
                    }
                ]
            }
        ]
    });
}